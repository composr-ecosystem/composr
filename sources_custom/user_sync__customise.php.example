<?php /*

 Composr
 Copyright (c) ocProducts, 2004-2023

 See docs/LICENSE.md for full licensing information.

*/

/**
 * @license    http://opensource.org/licenses/cpal_1.0 Common Public Attribution License
 * @copyright  ocProducts Ltd
 * @package    user_sync
 */

/*

Customise this code for your particular import scenario.

*/

function get_user_sync_env()
{
    $db_type = get_db_type();
    $db_host = get_db_site_host();
    $db_name = 'somedb';
    $db_user = get_db_site_user();
    $db_password = get_db_site_password();
    $db_table = 'users';
    $db_field_delim = '`';

    //$username_fields=['Forename','Surname']; // Fields that forms the username
    $username_fields = ['user_idn']; // Probably better: will be unique
    $username_fields_types = ['VARCHAR'];

    $time_field = null; // Set to a field name, to reduce the complexity of re-syncs

    $field_remap = [
        /*'
        e.g.

        CMS FIELD NAME (without prefix)' => [
            'LOOKUP TYPE (default, field, or callback)',
            'SOURCE FIELD NAME or VALUE or CALLBACK',
            [REMAPS [optional]],
            [REVERSE REMAPS [optional]],
            'DESTINATION TYPE [optional - defaults to something based upon PHP type; expects a standard SQL type name]',
        ],
        */

        'pass_hash_salted' => [],
        'email_address' => [],
        'groups' => [],
        'dob_day' => [],
        'dob_month' => [],
        'dob_year' => [],
        'timezone_offset' => [],
        'primary_group' => [],
        'validated' => [],
        'is_perm_banned' => [],
        'reveal_age' => [],
        'photo_url' => [],
        'language' => [],
        'allow_emails' => [],
        'allow_emails_from_staff' => [],

        // CPFs...
        'fullname' => [],
        'firstname' => [],
        'lastname' => [],
        'country' => [],
        'state' => [],
        'city' => [],
        'building_name_or_number' => [],
        'post_code' => [],
        'mobile_phone_number' => [],
        'payment_type' => [],
        'payment_cardholder_name' => [],
        'payment_card_number' => [],
        'payment_card_start_date' => [],
        'payment_card_expiry_date' => [],
    ];

    $default_password = null; // NULL means random password
    $temporary_password = true;

    return [
        $db_type,
        $db_host,
        $db_name,
        $db_user,
        $db_password,
        $db_table,

        $db_field_delim,

        $username_fields,
        $username_fields_types,
        $time_field,

        $field_remap,

        $default_password,
        $temporary_password,
    ];
}

function get_user_sync__begin($dbh, $since)
{
}

function get_user_sync__finish($dbh, $since)
{
}
